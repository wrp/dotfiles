#!/bin/sh

top=$(git rev-parse --show-toplevel)
cwd=$(pwd | sed "s@${top}@@")

if test -t 1; then
	white() { tput setaf 7; }
	blue() { tput setaf 4; }
	cyan() { tput setaf 6; }
	yellow() { tput setaf 3; }
	green() { tput setaf 2; }
else
	white() { :; }
	blue() { :; }
	cyan() { :; }
	yellow() { :; }
	green() { :; }
fi

remote="$(command git rev-parse --symbolic-full-name @{upstream} 2> /dev/null)"
branch="$(git rev-parse --abbrev-ref HEAD)"
printf 'cwd=%s%s %s%s\n' \
	"$(white)$top/" \
	"$(cyan)${cwd#/}" \
	"$(yellow)branch=${branch}" \
	"$(green)${remote:+ remote=${remote#refs/remotes/}}"

if test -n "$status"; then git s; fi
if test -n "$branch"; then git b; fi
