#!/bin/sh

test "$1" = . && set --

dir=$(realpath "${1-$PWD}" 2> /dev/null)
name=$(basename "${1-$PWD}")

if test -z "$TMUX"; then
	tmux attach -t "$name" 2> /dev/null \
	|| tmux new-session -c "$dir" -s "$name"
	exit
fi

if ! tmux has-session -t "${name}" 2> /dev/null; then

	# Create new session with multiple windows.  Default 3, max 9
	tmux new-session -c "$dir" -s "$name" -d
fi
tmux switch-client -t "$name"
