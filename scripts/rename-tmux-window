#!/bin/sh


if test -z "$TMUX"; then
	if test -n "$V"; then
		printf 'Not currently in a tmux session session\n' >&2
	fi
	exit 1
fi

test -z "$*" && {
	if git_dir=$(git rev-parse --absolute-git-dir 2> /dev/null); then
		set "$(basename $(dirname "$git_dir"))"
	else
		set "$(pwd 2> /dev/null)"
	fi
}

if test -z "$left_justify"; then
	patt='.*\(.\{19\}\)'
	repl='<\1'
else
	patt='\(.\{19\}\).*'
	repl='\1>'
fi

title=$( echo "$*" | sed '/.\{20\}/s/^'$patt'$/'$repl/)

tmux rename-window -- "${DOCKER+$DOCKER:}$title"
