#!/bin/sh


adjust=2
case $1 in
.    ) target=$TMUX_PANE; : $((adjust += 2)) ;;
[0-9]) target=$1.0 ;;
*    ) target=$1 ;;
esac

if test "${2-0}" -ne 0; then
	end=$(( $(tmux display-message -pt "$target" -F '#{pane_height}') - $adjust))
	start=$(( end - $2 ))
else
	start=-
	end=-
fi

tmux capture-pane -p -E "$end" -S "$start" -t "$target"
