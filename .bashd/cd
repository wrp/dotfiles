cd() {
	local _SESSION_DIR
	local _dir="$1"
	if test $# -gt 1; then
		echo 'cd takes at most one argument' >&2
		return 1
	fi
	if test "$#" = 0; then
		_SESSION_DIR=$(tmux show-options -s @dir 2> /dev/null \
			| awk '{print $2}')
	elif test -f "$1"; then
		_dir=$( dirname "$1" )
		echo cd: Truncating target to $_dir >&2
	fi
	command cd "${_dir:-${_SESSION_DIR:-${USE_HOME:-$HOME}}}"
}
