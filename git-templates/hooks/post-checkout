#!/bin/sh

remote=$( git rev-parse --symbolic-full-name --abbrev-ref @{u} 2> /dev/null \
	| cut -d / -f 1 )

url=$( git ls-remote --get-url "$remote" 2> /dev/null )

assigned=

while read project email name; do
	test -z "$project" && continue
	case $url in
	*github.com:${project}*)
		git config user.email "${email-$EMAIL}"
		git config user.name "${name-$NAME}"
		assigned=1
	;;
	esac
done << EOF
$GITHUB
EOF

if test -z "$assigned"; then
	git config user.email "${EMAIL?}"
	git config user.name "${NAME?}"
fi

printf >&2 "name/email set to %s/%s\n" \
	"$(git config user.name)" \
	"$(git config user.email)"
